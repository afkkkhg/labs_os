1. Нам предоставили три сервера: rrobin, web1, web2.
2. На серверах web1, web2 мы настраивали Nginx так, чтобы он работал по порту 8080 и отдавал кастомную страницу, зайдя на которую можно понять на каком сервере мы находимся.
3. А на сервере rrobin Nginx должен сохраняться баланс нагрузки серверов web1 и web2 в режиме round-robin, при этом вес каждого сервера одинаковый.
4. Установка и настройка всего ПО должна быть обеспечена Ansible-сценарием.
5. И так я в конфигурационном файле добавляла следующие параметры:
inventory файл, vagrant файл, на значении host_key_checking выставляем False, на значение defualt_transport указываем smart.
6.Далее я создаю inventory файл, с помощью которого будет указано на каких хостах нужно выполнить сценарий ansible. Также указываю ip этих двух серверов и ip балансеров rrobin.
7.В Playbook nginx.yml. Проходит установка nginx на заданной роли машине webserver отключение службы selinux.
8.Roles balancer - данная роль- балансер отвечает за распределение нагрузки на веб-ресурсы, используя алгоритм балансировки round robin. Имея одинаковые веб-ресурсы с разными ip адресами, но одинаковым содержимым веб-страниц, осуществляется постоянный перебор ip адресов веб-ресурсов, тем самым новое подключение будет осуществляться на разные ip адреса.
9.Roles webserver - роль- вебсервер отвечает за настройку веб-сервера nginx на 2-ух серверах с расположенными на них веб-ресурсами.
10.Запуск сценариев:
1.1. убедилась в работоспособности: написав : vagrant status, узнаю о текущем состоянии вирт машины.(vagrant uр)
1.2. запуск плейбука nginх: ansible-playbook haproxy.yml - убеждаюсь в работоспособности, на выводе получаем: nginx : ok=2 changed=0 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0.
11. В итоге получаю: вход на веб-страницы по адресу http://192.168.11.113:8080 (ип балансера). При обновлении страницы с очисткой кэша страницы, должно происходить заранее прописанное изменение в разметке веб-страницы на одной из веб-страничек для отличия их от друг друга, чтобы убедится в работоспособности балансировщика.



